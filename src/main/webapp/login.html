<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>司机管理后台</title>
<link href="css/style.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script type="text/javascript">
	$(function(){
		var phone = window.localStorage.phone;
		var password = window.localStorage.password;
		if(phone == undefined){
		
		}else{
			$("#phone").val(phone);
			$("#user_password").val(password);
			$(".login-p input").attr("checked","checked")
		}
		
		$(".login-button").click(function(){
			
			var ss = /^0?1[3|4|5|8|7][0-9]\d{8}$/;
			if(ss.test($("#phone").val())){
			}else if($("#phone").val() == "admin"){
			}else{
				alert("请输入正确的手机号码");
				return;
			}
			if($("#phone").val() == ""){
				alert("用户名不能为空");
				return;
			}
			if($("#user_password").val() == ""){
				alert("密码不能为空");
				return;
			}
			$(".login-jz").show();
			$.ajax({
				url:'/people/login',
				data:{'phone':$("#phone").val(),'password':$("#user_password").val()},
				dataType:'json',
				success:function(data){
					if(data.s == 0){
						$(".redd").html("用户名或密码错误");
						$(".login-jz").hide();
						return;
					}
					
					window.localStorage.Phone = data.peopleProfile.peoplePhone;
					window.localStorage.Name = data.peopleProfile.peopleName;
					var _html = "<ul>"
					var h = 0;
					$.each(data.peopleModuleTree,function(a,b){
					     h += 1;
						_html += "<li class='parentMenu'><span class='menuspan"+ h +"'>"+b.moduleName+"</span><ul class='second' style='display:none'>"
						$.each(b.childs,function(d,f){
							
							_html += "<li><a id="+f.moduleId+" href='"+f.moduleURL+"'>"+f.moduleName+"</a></li>"
						})
						_html += "</ul></li>"
					})
					 _html += "</ul>";
					window.localStorage.data = _html;
					var Storage = ""
					if(data.peopleStorage == ""){
						
					}else{
						$.each(data.peopleStorage,function(d,e){
						Storage += "<option value="+e.id+">"+e.name+"</option>"
						})
					}
					window.localStorage.storage = Storage;
					
					
					
					if($(".login-p input").attr("checked")){
					    window.localStorage.phone = $("#phone").val();
						window.localStorage.password = $("#user_password").val();
					}else{
						
					}
					
				window.location.href = "/index-ht.html";
					
					
				}
			})
			
			
			
		})
		
		
		
		$("#phone").focus(function(){
			$(".redd").html("")
		})
		$("#user_password").focus(function(){
			$(".redd").html("")
		})
		$(".login-an").click(function(){
			$(".login-jz").hide();
		})
		
		$(window).keydown(function (e) { 
			if (e.which == 13) { 
				$(".login-button").click();
			} 
		})
	})

</script>




</head>

<body style="overflow:hidden;">
	<div class="w980 pr">
		<div class="bg pa"></div>
		<div class="login-top-text"><strong>91农业</strong>-植根农业&nbsp;&nbsp;服务社区</div>
		<div class="login-box">
			<div class="login-img fl">
				<img src="images/login-pic.png" width="244" />
			</div>
			<div class="login fl">
				<h2>司机管理后台</h2>
				<p class="redd" style="height:18px;line-height:18px;margin:0;"></p>
				<p><input type="text" id="phone" class="login-input" placeholder="请输入用户名" /></p>
				<p><input type="password" id="user_password" class="login-input" placeholder="请输入密码" /></p>
				<p class="login-p"><input type="checkbox" /><span>记住帐号密码<span></p>
				<input type="button" class="login-button" value="登录" />
			</div>
		</div>
		<div class="login-bottom">Copyright ©上海集盛信息科技有限公司</div>
	</div>
	<div class="login-jz" style="display:none;"><p><img src="../images/login.gif" /><br /><a class="login-an" href="javascript:void(0)" >重新登录</a></p></div>
	
</body>
</html>
